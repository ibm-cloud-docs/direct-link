---

copyright:
  years: 2017, 2018
lastupdated: "2018-07-25"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}

# IBM Cloud での Virtual Routing and Forwarding (VRF) の概要

定義によると、Virtual Routing and Forwarding (VRF) は インターネット・プロトコル (IP) ネットワーク・ルーターに含まれる技術です。 これは、内在するバックボーン・サービスとして提供されます。

## IBM Cloud の接続オプション

**分散クラウド・リソース**とは、複数のロケーションにあるリソースです。複数のサブネットまたは VLAN 内にある場合もあります。 これらのリソースには、プライベート・ネットワークのコンテキスト内でも、相互に通信するためのルーティング機能が必要です。 本資料では、_カスタマー VRF_ とよく呼ばれる「マルチ分離」テナンシー通信オプションについて説明します。 これは、グローバル IBM Cloud バックボーンで MPLS Layer-3 VPN (RFC 4364) として実装されます。

一般的に、IBM Cloud プラットフォームでは、プライベート・ネットワークでルーティングを行ってポッドやデータ・センター間で接続を提供するために 2 つのオプションがあります。 

1. **共有テナンシー:** このモデルを使用するすべてのテナントで共有され、自動のアクセス制御リスト (ACL) で分離が提供され、VLAN スパンニングで実現される共通の論理ネットワーク。 (このオプションについては、本資料で説明しません。)

2. **マルチ分離:** テナント単位の専用論理ネットワーク。他のテナントの論理ネットワークとの相互作用は許可されません。  

本資料では、**「カスタマー VRF」**という言葉を使用して、_マルチ分離_ ネットワーク接続について説明します。

## カスタマー VRF の概要

Virtual Routing and Forwarding (VRF) により、ルーティング・テーブルの複数のインスタンスがルーターに存在して同時に機能することができます。 Virtual Routing and Forwarding (VRF) では、それぞれのお客様の VRF ネットワークがルーティング・テーブル内でセグメント化されます。 このセグメンテーションにより、IP アドレスのオーバーラップが許されます。他のカスタマー VRF との相互作用や干渉は生じません。 IBM Cloud は、`10.0.0.0/8` ネットワークの大部分を使用します。これは多くのお客様のリモート・ネットワークとオーバーラップする可能性があります。 

Virtual Routing and Forwarding (VRF) を使用すると、お客様は、グローバル・テーブルでオーバーラップすることが通常許されないリモート IP アドレスの使用が可能になります。 IBM は引き続き、次の RFC 1918 のリンク・ローカル・アドレスおよびマルチキャスト・アドレス (これらは、この VRF サービスからルーティングできません) を予約しています。

* `10.0.0.0/14` 
* `10.200.0.0/14` 
* `10.198.0.0/15` 
* `169.254.0.0/16` 
* `224.0.0.0/4` 
* `166.9.0.0/16` (プライベート・エンドポイント・サービスが使用)
* IBM プラットフォーム上でお客様の VLAN に割り当てられたすべての IP 範囲。

IBM は、アベイラビリティー・ゾーン (AZ) で仮想プライベート・クラウド (VPC) を可能にする次世代のクラウド・デプロイメントを進めていきます。 この新しい VPC 機能により、ダラス、ワシントン DC、ロンドン、フランクフルト、東京、シドニーにある、VPC が使用可能な AZ で、お客様が Bring Your own IP (BYoIP) を使用することが可能になります。 

Virtual Routing and Forwarding (VRF) を使用する、バックボーン上の各テナントには、Direct Link 当たり、ただ 1 つの _カスタマー VRF_ が可能で、これが、ロケーションに関係なく、テナントの全サーバー間の接続を提供します。 しかし、お客様は、単一の相互接続ルーターにフィードする複数の Direct Link アカウントを持つことができます。  

* 1 つのテナントの、世界中にあるすべての VLAN 内、ポッド内、データ・センター内のサーバーが、グローバルで当該テナントの他のすべてのサーバーに到達することができます。 

* すべてのテナントのカスタマー VRF は、共通の共有サービス・ネットワークに接続され、そうしたサーバーが DNS、共有ストレージ、モニター、パッチなどを使用するためにプライベートに到達できるようにしています。

* カスタマー VRF は、テナント間の分離を提供する接続サービスです。 そのほかにテナンシー内で必要な制御があれば、ゲートウェイ、セキュリティー・グループ、ホスト・ベースの制御などを使用して、別個にプロビジョンする必要があります。

## カスタマー VRF に移行する利点

**カスタマー VRF の主な利点として、以下があります。**

* 業界で実証され、広く受け入れられた_マルチ分離_ の分割テクノロジー。 多くのお客様が、Level-3 VPN アプローチが (ACL より) 監査者やコンプライアンス担当者から受け入れられやすいと捉えています。   

* IBM ネットワーク全体でのサイトまたはアプリケーションの新規追加によって、お客様はネットワークの到達範囲を著しく拡張したりマイグレーションしたりすることができます。 

* テナント固有のルーティング・テーブルによって、他のテナントのサブネットや他の適用できないネットワーク部分とオーバーラップするリスクがなくなり、IP アドレスがオーバーラップする可能性が低くなります。 

**以前の ACL モデルと比較して、カスタマー VRF では、以下の小さなトレードオフが伴います。**  

* カスタマー VRF への変換には、バックボーンのトラフィック・フローを短時間中断する保守時間が必要になります。

* 管理対象 VPN サービス (SSL、IPSec) によるリモート・アクセスは、ローカル・データ・センターに限定されます。ただし、共有 ACL バックボーンは、すべてのエントリー・ポイントからのグローバル・アクセスを許可します。

* お客様の_マルチ分離_ テナンシー内の VLAN スパンニングは使用できません。

## アカウント変換プロセスで何が起こるか

多くのお客様が現在、IBM Cloud ネットワーク上の共有テナンシー・モデルで運用しています。 変換中に、テナンシーは、多くの場合は新しい Direct Link サブスクリプションを使用して、あるいは、その他の要求された方法で、カスタマー VRF を使用するように変換されます。  

変換プロセスでは、VLAN とそのサブネットが ACL バックボーンから切断されてカスタマー VRF に接続される間に、ネットワークの中断が伴います。 このプロセスでは、VLAN に着信または VLAN から発信するトラフィックで短時間のパケット・ロスが発生します。 VLAN 内のパケットの流れは続行します。 FortiGate セキュリティー・アプライアンスまたは仮想ルーター・アプライアンスなどのネットワーク・ゲートウェイが含まれる場合は、そのゲートウェイに接続された VLAN 間で中断は発生しません。 サーバー自体にネットワーク障害は発生せずに、トラフィック・フローの再開時に、ほとんどのワークロードが自動的にリカバリーします。 中断の合計時間は、テナントのトポロジーの規模、つまり、当該テナンシーに含まれるサブネット、VLAN、ポッドの数によって異なります。

![変換プロセス](/images/vrf-on-ibm-cloud.png)

マイグレーションの間、お客様の VLAN はバックボーンから切断され、カスタマー VRF に再接続されます。  中断時間は、関与する VLAN、ポッド、データ・センターの数によって異なります。 VLAN 間のトラフィックは中断しますが、サーバーはネットワークに接続されたままになります。 アプリケーションは、パケット・ロスに対する感度に応じて、影響を受けることも、受けないこともあります。

## 変換を開始する方法

お客様が [IBM Cloud コンソール ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")]( https://control.bluemix.net/support/unifiedConsole/tickets/add) のアカウントでサポート・チケットをオープンし、VRF へのマイグレーションをリクエストすることができます。 チケットには、「プライベート・ネットワークについて (Private Network Question)」と記述して、サポート・チケットに以下のテキストを含めてください。 

「アカウント _アカウント番号を入力_ を固有の VRF に移行することをリクエストします (We are requesting that account _fill in your account number_ is moved to its own VRF)。リスクについて理解しています。変更に同意します (We understand the risks and approve the change)。 マイグレーションに向けた準備のために、この変更が行われるスケジュール時間を含めて返信してください (Please reply back with the scheduled window(s) of time where this change will be made so we can prepare for the migration)。 

IBM Cloud ネットワーク・エンジニアリング・チームがマイグレーションを実行します。 同意したスケジュール以外に、お客様からの情報は不要です。 アカウントの複雑度に応じて、通常、パケット・ロスは 15 分から 30 分続く可能性があります。 (お客様がレガシー Direct Link 接続をご使用の場合は、さらに長くなることがあります。) このプロセスは高度に自動化されています。 IBM チームによる最低限の処理がありますが、お客様からは認識されません。
